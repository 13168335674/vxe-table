"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils/methods/xe-utils")),_conf=_interopRequireDefault(require("../../conf")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default={filter:function(e,t){var i=this.getColumnByField(e),l=i.filters;if(t){var o=t(l);_xeUtils.default.isArray(o)&&(i.filters=_tools.UtilTools.getFilters(o))}return Promise.resolve(l)},triggerFilterEvent:function(e,t,i){var l=this.$refs,o=this.filterStore;if(o.column===t&&o.visible)o.visible=!1;else{var r=l.filterWrapper,s=e.target,n=e.pageX,a=_tools.DomTools.getDomNode().visibleWidth,c=_tools.DomTools.getAbsolutePos(s),u=c.top,f=c.left;Object.assign(o,{args:i,multiple:t.filterMultiple,options:t.filters,column:t,style:{zIndex:_conf.default.tooltip.zIndex,top:"".concat(u+s.clientHeight+6,"px"),left:"".concat(f,"px")},visible:!0}),o.isAllSelected=o.options.every(function(e){return e.checked}),o.isIndeterminate=!o.isAllSelected&&o.options.some(function(e){return e.checked}),this.$nextTick(function(){var e=r.$el.clientWidth,t=f-e/2+10;a<n+e&&(t=f-e),o.style.left="".concat(Math.max(20,t+20),"px"),o.style.top="".concat(u+s.clientHeight+6,"px")})}},confirmFilterEvent:function(e){var t=this.visibleColumn,i=this.filterStore,l=this.remoteFilter,o=this.scrollXLoad,r=this.scrollYLoad,s=i.column,n=s.property,a=[],c=[];s.filters.forEach(function(e){e.checked&&(a.push(e.value),c.push(e.data))}),i.visible=!1,l||this.handleTableData(!0);var u=[];t.filter(function(e){var t=e.property,i=e.filters,l=[],o=[];i&&i.length&&(i.forEach(function(e){e.checked&&(l.push(e.value),o.push(e.data))}),u.push({column:e,property:t,field:t,prop:t,values:l,datas:o}))}),_tools.UtilTools.emitEvent(this,"filter-change",[{column:s,property:n,field:n,prop:n,values:a,datas:c,filters:u,$table:this}]),this.updateFooter(),(o||r)&&(this.clearScroll(),r&&this.updateScrollYSpace()),this.closeFilter(),this.$nextTick(this.recalculate)},resetFilterEvent:function(e){this.filterStore.options.forEach(function(e){e.checked=!1,e.data=e._data}),this.confirmFilterEvent(e)},clearFilter:function(e){var t=arguments.length?this.getColumnByField(e):null,i=this.filterStore,l=function(e){var t=e.filters;t&&t.length&&t.forEach(function(e){e.checked=!1,e.data=e._data})};return t?l(t):this.visibleColumn.forEach(l),t&&t===i.column||Object.assign(i,{isAllSelected:!1,isIndeterminate:!1,style:null,options:[],column:null,multiple:!1,visible:!1}),this.updateData()}};exports.default=_default;