"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _table=_interopRequireDefault(require("../../table"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),o.forEach(function(e){_defineProperty(t,e,r[e])})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var methods={},excelEditConfig={trigger:"dblclick",mode:"cell",showIcon:!1,showStatus:!1};Object.keys(_table.default.methods).forEach(function(e){methods[e]=function(){return this.$refs.xTable[e].apply(this.$refs.xTable[e],arguments)}});var excelContextMenu={header:{options:[[{code:"exportAll",name:"隐藏列"},{code:"exportAll",name:"取消所有隐藏"}]]},body:{options:[[{code:"insert",name:"插入"},{code:"remove",name:"删除"},{code:"clearData",name:"清除内容"}],[{code:"sort",name:"排序",children:[{code:"clearSort",name:"清除排序"},{code:"sortAsc",name:"升序"},{code:"sortDesc",name:"倒序"}]}],[{code:"exportAll",name:"导出数据.csv"}]]}},_default={name:"VxeExcel",props:_objectSpread({columns:Array},_table.default.props),data:function(){return{excelStore:{uploadRows:[]}}},computed:{tableProps:function(){var e=this.$props,t=this.editConfig;return _objectSpread({},e,{border:!0,resizable:!0,showOverflow:null,contextMenu:excelContextMenu,mouseConfig:{selected:!0,checked:!0},keyboardConfig:{isArrow:!0,isDel:!0,isTab:!0,isCut:!0,isEdit:!0},editConfig:Object.assign({},excelEditConfig,t),optimization:{scrollX:{gt:100,oSize:6,rSize:20},scrollY:{gt:100,oSize:30,rSize:80}}})}},watch:{columns:function(e){this.loadColumn(e)}},mounted:function(){var e=this.columns;e&&e.length&&this.loadColumn(this.columns)},render:function(e){var t=this.$slots,r=this.$listeners;return e("vxe-table",{class:"vxe-excel",props:this.tableProps,on:_objectSpread({},r,{"context-menu-click":this.contextMenuClickEvent}),ref:"xTable"},t.default)},methods:_objectSpread({},methods,{contextMenuClickEvent:function(e,t){var r=e.menu,o=e.row,n=e.column,a=this.$refs.xTable,c=n.property;switch(r.code){case"insert":a.insertAt({},o);break;case"remove":a.remove(o);break;case"clearData":a.clearData(o,c);break;case"clearFilter":a.clearFilter();break;case"clearSort":a.clearSort();break;case"sortAsc":a.sort(c,"asc");break;case"sortDesc":a.sort(c,"desc");break;case"exportAll":a.exportCsv({isHeader:!1})}}})};exports.default=_default;