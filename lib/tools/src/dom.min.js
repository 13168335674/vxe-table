"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.DomTools=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils")),_utils=_interopRequireDefault(require("./utils"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var browse=_xeUtils.default.browse(),htmlElem=document.querySelector("html"),bodyElem=document.body;function rClass(e){return new RegExp("(?:^|\\s)".concat(e,"(?!\\S)"),"g")}function rClassList(e){return new RegExp(e.map(function(e){return"(?:^|\\s)".concat(e,"(?!\\S)")}).join("|"),"g")}var rClsMap={},preClss=["row--hover","row--current","col--current","col--selected","col--index-checked","col--title-checked","scrolling--middle"],preClsMap={"col--checked":["col--checked-top","col--checked-bottom","col--checked-left","col--checked-right"],"col--copyed":["col--copyed-top","col--copyed-bottom","col--copyed-left","col--copyed-right"]};preClss.forEach(function(e){rClsMap[e]=rClass(e)}),_xeUtils.default.each(preClsMap,function(e,t){rClsMap[t]=rClassList([t].concat(e))});var DomTools={browse:browse,isPx:function(e){return e&&/^\d+(px)?$/.test(e)},isScale:function(e){return e&&/^\d+%$/.test(e)},hasClass:function(e,t){if(e){var o=e.className;return(preClss[t]||rClass(t)).test(o)}return!1},removeClass:function(e,t){e&&DomTools.hasClass(e,t)&&(e.className=e.className.replace(rClsMap[t]||rClass(t),""))},addClass:function(e,t){e&&!DomTools.hasClass(e,t)&&(DomTools.removeClass(e,t),e.className="".concat(e.className," ").concat(t))},scrollIntoElem:function(e){e&&(e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():e.scrollIntoView&&e.scrollIntoView())},getDomNode:function(){return{scrollTop:document.documentElement.scrollTop||document.body.scrollTop,scrollLeft:document.documentElement.scrollLeft||document.body.scrollLeft,visibleHeight:document.documentElement.clientHeight||document.body.clientHeight,visibleWidth:document.documentElement.clientWidth||document.body.clientWidth}},getEventTargetNode:function(e,t,o){for(var r,n=e.target;n&&n.nodeType&&n!==document;){if(o&&DomTools.hasClass(n,o))r=n;else if(n===t)return{flag:!o||!!r,container:t,targetElem:r};n=n.parentNode}return{flag:!1}},getOffsetPos:function(e,t){return getNodeOffset(e,t,{left:0,top:0})},getAbsolutePos:function(e){var t=e.getBoundingClientRect(),o=DomTools.getDomNode(),r=o.scrollTop,n=o.scrollLeft;return{top:r+t.top,left:n+t.left}},getCellNodeIndex:function(e){var t=e.parentNode;return{columnIndex:_xeUtils.default.arrayIndexOf(t.children,e),rowIndex:_xeUtils.default.arrayIndexOf(t.parentNode.children,t)}},getRowNodes:function(e,t,o){for(var r=t.columnIndex,n=t.rowIndex,l=o.columnIndex,s=o.rowIndex,c=[],a=Math.min(n,s),d=Math.max(n,s);a<=d;a++){for(var i=[],u=e[a],f=Math.min(r,l),m=Math.max(r,l);f<=m;f++){var p=u.children[f];i.push(p)}c.push(i)}return c},getCellIndexs:function(e){var t=e.parentNode,o=e.getAttribute("data-index"),r=t.getAttribute("data-rowid"),n=[].indexOf.call(t.children,e);return{rowId:r,rowIndex:[].indexOf.call(t.parentNode.children,t),colIndex:o?parseInt(o):o,columnIndex:n}},getCell:function(e,t){var o=t.row,r=t.rowIndex,n=t.column,l=_utils.default.getRowId(e,o,r);return e.$refs.tableBody.$el.querySelector('.vxe-body--row[data-rowid="'.concat(l,'"] .').concat(n.id))},getCursorPosition:function(e){var t={text:"",start:0,end:0};if(e.setSelectionRange)t.start=e.selectionStart,t.end=e.selectionEnd,t.text=t.start!==t.end?e.value.substring(t.start,t.end):"";else if(document.selection){var o=0,r=document.selection.createRange(),n=document.body.createTextRange();for(n.moveToElementText(e),t.text=r.text,t.bookmark=r.getBookmark();n.compareEndPoints("StartToStart",r)<0&&0!==r.moveStart("character",-1);o++)"\n"===e.value.charAt(o)&&o++;t.start=o,t.end=t.text.length+t.start}return t},setCursorPosition:function(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t.start,t.end);else if(e.createTextRange){var o=e.createTextRange();e.value.length===t.start?o.collapse(!1):o.moveToBookmark(t.bookmark),o.select()}}};function getNodeOffset(e,t,o){if(e){var r=e.parentNode;if(o.top+=e.offsetTop,o.left+=e.offsetLeft,r&&r!==htmlElem&&r!==bodyElem&&(o.top-=r.scrollTop,o.left-=r.scrollLeft),(!t||e!==t&&e.offsetParent!==t)&&e.offsetParent)return getNodeOffset(e.offsetParent,t,o)}return o}var _default=exports.DomTools=DomTools;exports.default=_default;