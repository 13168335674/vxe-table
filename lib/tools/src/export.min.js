"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.ExportTools=void 0;var _utils=_interopRequireDefault(require("./utils")),_dom=_interopRequireDefault(require("./dom"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var ExportTools={getCsvContent:function(e,t,o,a){var n=e.original,r=getCsvData(e,t,o,a),l=r.columns,i=r.datas,u="\ufeff";return e.isHeader&&(u+=l.map(function(e){return e.label}).join(",")+"\n"),i.forEach(function(t,o){u+=n?l.map(function(e){return"index"===e.type?'"'.concat(e.indexMethod?e.indexMethod(o):o+1,'"'):'"'.concat(_utils.default.getCellValue(t,e)||"",'"')}).join(",")+"\n":l.map(function(e){return'"'.concat(t[e.id],'"')}).join(",")+"\n"}),u},downloadCsc:function(e,t){if(!e.download)return Promise.resolve(t);if(navigator.msSaveBlob&&window.Blob)navigator.msSaveBlob(new Blob([t],{type:"text/csv"}),e.filename);else if(_dom.default.browse["-ms"]){var o=window.top.open("about:blank","_blank");o.document.charset="utf-8",o.document.write(t),o.document.close(),o.document.execCommand("SaveAs",e.filename),o.close()}else{var a=document.createElement("a");a.target="_blank",a.download=e.filename,a.href=getCsvUrl(e,t),document.body.appendChild(a),a.click(),document.body.removeChild(a)}}};function getCsvLabelData(e,t,o){var a=o.querySelectorAll(".vxe-table--body-wrapper.body--wrapper .vxe-body--row");return Array.from(a).map(function(o){var a={};return e.forEach(function(e){var t=o.querySelector(".".concat(e.id));a[e.id]=t?t.innerText.trim():""}),a})}function getCsvData(e,t,o,a){var n=e.original,r=e.columns?e.columns:o;e.columnFilterMethod&&(r=r.filter(e.columnFilterMethod));var l=e.data?e.data:n?t:getCsvLabelData(r,t,a);return e.dataFilterMethod&&(l=l.filter(e.dataFilterMethod)),{columns:r,datas:l}}function getCsvUrl(e,t){return window.Blob&&window.URL&&window.URL.createObjectURL&&!_dom.default.browse.safari?URL.createObjectURL(new Blob([t],{type:"text/csv"})):"data:attachment/csv;charset=utf-8,".concat(encodeURIComponent(t))}var _default=exports.ExportTools=ExportTools;exports.default=_default;