"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils")),_conf=_interopRequireDefault(require("../../conf")),_vXETable=require("../../v-x-e-table"),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var Cell={createColumn:function(e,r){var n=r.type,t=r.sortable,l=r.remoteSort,o=r.filters,d=r.editRender,i=r.treeNode,a=e.selectConfig,c=e.treeConfig&&i,s={renderHeader:this.renderHeader,renderCell:c?this.renderTreeCell:this.renderCell};switch(n){case"index":s.renderHeader=this.renderIndexHeader,s.renderCell=c?this.renderTreeIndexCell:this.renderIndexCell;break;case"radio":s.renderHeader=this.renderRadioHeader,s.renderCell=c?this.renderTreeRadioCell:this.renderRadioCell;break;case"selection":s.renderHeader=this.renderSelectionHeader,s.renderCell=a&&a.checkProp?c?this.renderTreeSelectionCellByProp:this.renderSelectionCellByProp:c?this.renderTreeSelectionCell:this.renderSelectionCell;break;case"expand":s.renderCell=this.renderExpandCell,s.renderData=this.renderExpandData;break;default:d?(s.renderHeader=this.renderEditHeader,s.renderCell=e.editConfig&&"cell"===e.editConfig.mode?c?this.renderTreeCellEdit:this.renderCellEdit:c?this.renderTreeRadioCell:this.renderRowEdit):o&&o.length&&(t||l)?s.renderHeader=this.renderSortAndFilterHeader:t||l?s.renderHeader=this.renderSortHeader:o&&o.length&&(s.renderHeader=this.renderFilterHeader)}return _tools.UtilTools.getColumnConfig(r,s)},renderHeader:function(e,r){var n=r.column.slots;return n&&n.header?n.header(r):[_tools.UtilTools.formatText(r.column.origin.label)]},renderCell:function(e,r){var n,t=r.row,l=r.rowIndex,o=r.column,d=r.columnIndex,i=o.slots,a=o.formatter;return i&&i.default?i.default(r):(n=_tools.UtilTools.getCellValue(t,o),a&&(n=a({cellValue:n,row:t,rowIndex:l,column:o,columnIndex:d})),[_tools.UtilTools.formatText(n)])},renderTreeCell:function(e,r){return Cell.renderTreeIcon(e,r).concat(Cell.renderCell(e,r))},renderTreeIcon:function(e,r){var n=_conf.default.iconMap,t=r.$table,l=t.treeConfig,o=t.treeExpandeds,d=r.row,i=r.level,a=l.children,c=l.indent,s=l.trigger,u=d[a],f={};return s&&"default"!==s||(f.click=function(e){return t.triggerTreeExpandEvent(e,r)}),[e("span",{class:"vxe-tree--indent",style:{width:"".concat(i*(c||16),"px")}}),e("span",{class:["vxe-tree-wrapper",{"is--active":-1<o.indexOf(d)}],on:f},u&&u.length?[e("i",{class:["vxe-tree--node-btn",n.tree]})]:[])]},renderIndexHeader:function(e,r){var n=r.column.slots;return n&&n.header?n.header(r):[_tools.UtilTools.formatText(r.column.origin.label||"#")]},renderIndexCell:function(e,r){var n=r.$table,t=r.column,l=n.startIndex,o=t.slots,d=t.indexMethod;if(o&&o.default)return o.default(r);var i=r.seq,a=r.level;return[_tools.UtilTools.formatText(d?d(r):a?"".concat(a,".").concat(i):l+i)]},renderTreeIndexCell:function(e,r){return Cell.renderTreeIcon(e,r).concat(Cell.renderIndexCell(e,r))},renderRadioHeader:function(e,r){return[_tools.UtilTools.formatText(r.column.origin.label)]},renderRadioCell:function(e,r){var n=r.$table,t=r.column,l=n.radioConfig,o=void 0===l?{}:l,d=t.slots,i=o.labelProp;if(d&&d.header)return d.header(r);var a=n.selectRow,c=r.row,s={attrs:{type:"radio",name:"vxe-radio--".concat(n.id)}};return r.isHidden||(s.domProps={checked:c===a},s.on={change:function(e){n.triggerRowEvent(e,r)}}),[e("label",{class:["vxe-radio"]},[e("input",s),e("span",{class:["radio--icon"]}),i?e("span",{class:"radio--label"},_xeUtils.default.get(c,i)):null])]},renderTreeRadioCell:function(e,r){return Cell.renderTreeIcon(e,r).concat(Cell.renderRadioCell(e,r))},renderSelectionHeader:function(e,r){var n=r.$table,t=r.column,l=t.slots;if(l&&l.header)return l.header(r);var o={attrs:{type:"checkbox"}};return r.isHidden||(o.domProps={checked:n.isAllSelected},o.on={change:function(e){n.triggerCheckAllEvent(e,e.target.checked)}}),[e("label",{class:["vxe-checkbox",{"is--indeterminate":n.isIndeterminate}]},[e("input",o),e("span",{class:["checkbox--icon"]}),t.origin.label?e("span",{class:"checkbox--label"},t.origin.label):null])]},renderSelectionCell:function(e,r){var n=r.$table,t=n.selectConfig,l=void 0===t?{}:t,o=n.treeConfig,d=n.treeIndeterminates,i=l.labelProp,a=l.checkMethod,c=r.row,s=!1,u=!!a,f={attrs:{type:"checkbox"}};return r.isHidden||(a&&(u=!a(r),f.attrs.disabled=u),o&&(s=-1<d.indexOf(c)),f.domProps={checked:-1<n.selection.indexOf(c)},f.on={change:function(e){n.triggerCheckRowEvent(e,r,e.target.checked)}}),[e("label",{class:["vxe-checkbox",{"is--indeterminate":s,"is--disabled":u}]},[e("input",f),e("span",{class:["checkbox--icon"]}),i?e("span",{class:"checkbox--label"},_xeUtils.default.get(c,i)):null])]},renderTreeSelectionCell:function(e,r){return Cell.renderTreeIcon(e,r).concat(Cell.renderSelectionCell(e,r))},renderSelectionCellByProp:function(e,r){var n=r.$table,t=n.selectConfig,l=void 0===t?{}:t,o=n.treeConfig,d=n.treeIndeterminates,i=l.labelProp,a=l.checkProp,c=l.checkMethod,s=r.row,u=!1,f=!!c,C={attrs:{type:"checkbox"}};return r.isHidden||(c&&(f=!c(r),C.attrs.disabled=f),o&&(u=-1<d.indexOf(s)),C.domProps={checked:_xeUtils.default.get(s,a)},C.on={change:function(e){n.triggerCheckRowEvent(e,r,e.target.checked)}}),[e("label",{class:["vxe-checkbox",{"is--indeterminate":u,"is--disabled":f}]},[e("input",C),e("span",{class:["checkbox--icon"]}),i?e("span",{class:"checkbox--label"},_xeUtils.default.get(s,i)):null])]},renderTreeSelectionCellByProp:function(e,r){return Cell.renderTreeIcon(e,r).concat(Cell.renderSelectionCellByProp(e,r))},renderExpandCell:function(e,r){var n=r.$table,t=!1;return r.isHidden||(t=-1<n.expandeds.indexOf(r.row)),[e("span",{class:["vxe-table--expanded",{"expand--active":t}],on:{click:function(e){n.triggerRowExpandEvent(e,r)}}},[e("i",{class:["vxe-table--expand-icon"]})])]},renderExpandData:function(e,r){var n=r.column.slots;return n&&n.default?n.default(r):[]},renderSortAndFilterHeader:function(e,r){return Cell.renderHeader(e,r).concat(Cell.renderSortIcon(e,r)).concat(Cell.renderFilterIcon(e,r))},renderSortHeader:function(e,r){return Cell.renderHeader(e,r).concat(Cell.renderSortIcon(e,r))},renderSortIcon:function(e,r){var n=_conf.default.iconMap,t=r.$table,l=r.column;return[e("span",{class:["vxe-sort-wrapper"]},[e("i",{class:["vxe-sort--asc-btn",n.sortAsc,{"sort--active":"asc"===l.order}],on:{click:function(e){t.triggerSortEvent(e,l,r,"asc")}}}),e("i",{class:["vxe-sort--desc-btn",n.sortDesc,{"sort--active":"desc"===l.order}],on:{click:function(e){t.triggerSortEvent(e,l,r,"desc")}}})])]},renderFilterHeader:function(e,r){return Cell.renderHeader(e,r).concat(Cell.renderFilterIcon(e,r))},renderFilterIcon:function(e,r){var n=_conf.default.iconMap,t=r.$table,l=r.column,o=t.filterStore;return[e("span",{class:["vxe-filter-wrapper",{"is--active":o.visible&&o.column===l}]},[e("i",{class:["vxe-filter--btn",n.filter],on:{click:function(e){t.triggerFilterEvent(e,r.column,r)}}})])]},renderEditHeader:function(e,r){var n,t=_conf.default.iconMap,l=r.$table,o=r.column,d=l.editRules,i=l.editConfig,a=o.sortable,c=o.remoteSort,s=o.filters;if(d){var u=_xeUtils.default.get(d,r.column.property);u&&(n=u.some(function(e){return e.required}))}return[n?e("i",{class:"vxe-required-icon"}):null,i&&!1===i.showIcon?null:e("i",{class:["vxe-edit-icon",t.edit]})].concat(Cell.renderHeader(e,r)).concat(a||c?Cell.renderSortIcon(e,r):[]).concat(s&&s.length?Cell.renderFilterIcon(e,r):[])},renderRowEdit:function(e,r){var n=r.$table.editStore.actived;return Cell.runRenderer(e,r,this,n&&n.row===r.row)},renderTreeRowEdit:function(e,r){return Cell.renderTreeIcon(e,r).concat(Cell.renderRowEdit(e,r))},renderCellEdit:function(e,r){var n=r.$table.editStore.actived;return Cell.runRenderer(e,r,this,n&&n.row===r.row&&n.column===r.column)},renderTreeCellEdit:function(e,r){return Cell.renderTreeIcon(e,r).concat(Cell.renderCellEdit(e,r))},runRenderer:function(e,r,n,t){var l=r.$table,o=r.column,d=o.slots,i=n?n.editRender:o.editRender,a=_vXETable.Renderer.get(i.name),c={$excel:l.$parent,$table:l,$column:o};return"visible"===i.type||t?d&&d.edit?d.edit(r):a&&a.renderEdit?a.renderEdit(e,i,r,c):[]:a&&a.renderCell?a.renderCell(e,i,r,c):Cell.renderCell(e,r)}},_default=Cell;exports.default=_default;